// Generated by CoffeeScript 1.7.1
(function() {
  var Gogo;

  Gogo = angular.module('Gogo', ['ngRoute']);

  this.GogoCtrl = [
    '$scope', '$http', '$location', function($scope, $http, $location) {
      var checkLogin, convertDate, searchNews;
      searchNews = function() {
        var url;
        url = "http://news.google.com/?output=rss";
        return $http.get(url).success(function(data, status, headers, config) {
          var items, newsItems, xml, xmlDoc;
          xmlDoc = $.parseXML(data);
          xml = $(xmlDoc);
          items = xml.find("item");
          newsItems = [];
          items.each(function() {
            var n;
            n = {
              'title': $(this).find('title').text(),
              'link': $(this).find('link').text()
            };
            return newsItems.push(n);
          });
          return $scope.items = newsItems;
        }).error(function(data, status, headers, config) {
          return console.log('Search Failed');
        });
      };
      checkLogin = function() {
        var url;
        url = '/app/login.html';
        if (localStorage.getItem('loggedIn')) {
          $scope.loggedIn = true;
          url = '/app/flight.html';
          if (localStorage.getItem('url')) {
            url = localStorage.getItem('url');
            if (url === '/app/news.html') {
              searchNews();
            }
          }
        }
        return $scope.templatePage = chrome.extension.getURL(url);
      };
      checkLogin();
      convertDate = function(timestamp) {
        var date, day, formattedDate, month, year;
        console.log(timestamp);
        date = new Date(timestamp * 1000);
        day = date.getDay();
        month = date.getMonth();
        year = date.getFullYear();
        formattedDate = "" + month + "/" + day + "/" + year;
        return formattedDate;
      };
      $scope.login = function() {
        $scope.loggedIn = true;
        localStorage.setItem('loggedIn', true);
        return $scope.templatePage = chrome.extension.getURL('/app/flight.html');
      };
      $scope.logout = function() {
        $scope.loggedIn = false;
        localStorage.setItem('loggedIn', false);
        return $scope.templatePage = chrome.extension.getURL('/app/login.html');
      };
      $scope.viewLogin = function() {
        return $scope.templatePage = chrome.extension.getURL('/app/login.html');
      };
      $scope.viewFlight = function() {
        $scope.templatePage = chrome.extension.getURL('/app/flight.html');
        return localStorage.setItem('url', '/app/flight.html');
      };
      $scope.viewNews = function() {
        $scope.templatePage = chrome.extension.getURL('/app/news.html');
        localStorage.setItem('url', '/app/news.html');
        return searchNews();
      };
      $scope.viewLeisure = function() {
        $scope.templatePage = chrome.extension.getURL('/app/leisure.html');
        return localStorage.setItem('url', '/app/leisure.html');
      };
      $scope.searchFlight = function() {
        var url;
        url = "http://gogo-test.apigee.net/v1/aircraft/flightno/" + this.airlineNumber + "?apikey=0XOAphNPi8w4nY1LAqVnhlUIPsBDV69Q";
        return $http.get(url).success(function(data, status, headers, config) {
          $scope.flight = data.FlightInfo;
          if (data.FlightInfo.ErrorCode) {
            return $scope.flightSearchSucceed = false;
          } else {
            return $scope.flightSearchSucceed = true;
          }
        }).error(function(data, status, headers, config) {
          return console.log('Search failed');
        });
      };
      $scope.openNewsLink = function(n) {
        return chrome.tabs.create({
          url: n.link
        });
      };
      return $scope.flightNotExist = function() {
        return angular.isUndefined($scope.flight);
      };
    }
  ];

}).call(this);

//# sourceMappingURL=controller.map
